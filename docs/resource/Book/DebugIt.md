# Debug it! 실용주의 디버깅

> 소프트웨어 개발자가 꼭 알아야 할 디버깅의 정석
>
> 폴 부처 지음 / 박 일 옮김

### 문제의 핵심 > 구조적 접근 (page 28.)

#### **실천하기**

다음은 꼭 지키자.

- 소프트웨어가 왜 이상하게 작동되는지 알기
- 문제를 고치기
- 다른 부분을 깨뜨리지 않기
- 전반적인 품질 유지나 향상시키기
- 같은 문제가 다른곳에도 있는지 확인하고 재발을 막기
  - 소프트웨어를 잘 활용해 어떤 일이 벌어지는지를 보여주자.
  - 한 번에 한 문제만 해결하자.
  - 무엇을 찾고 있는지를 정확하게 알자.
- 어떤일이 벌어지고 있는가?
- 어떻게 실행돼야 하는가?
  간단한 것부터 먼저 살피자.

### 문제의 핵심 > 재현 (page 60.)

#### **실천하기**

- 무엇보다도 먼저 재현 방법을 찾자.
- 버그가 발견된 버전의 소프트웨어를 실행하자.
- 재현하려는 환경을 버그가 발견된 환경과 똑같이 만들자.
- 버그 재현에 꼭 필요한 입력을 다음 방법을 통해 찾자.
  - 추론
  - 로그로 의심 가는 입력을 기록
  - 재현 방법을 반복해서 다듬어 신뢰할 수 있고 편리하게 만들자.
  - 재현 단계, 데이터 크기, 시간을 줄인다.
  - 비결정성 제거
  - 자동화

### 문제의 핵심 > 진단 (page 89.)

#### **인내**

그렇게 보이지 않을 때도 있겠지만 사실 진단할 수 없는 버그는 없다. 컴퓨터에서 실행되는 모든 소프트웨어는 사람이 작성한 것이고, 이런 소프트웨어에서 어떤 작업을 하는지 정확하게 알 수 있으므로 언제든지 충분한 정보를 얻을 수 있다. 이런 점에서 소프트웨어는 인간 세상의 다른 분야와는 참 다르다.

물론 진단이 쉽다는 건 아니다. 하지만 지금 보고 있는 문제 때문에 좌절하더라도 언제나 길은 있다는 점을 잊지 말자. 충분한 시간과 노력, 각오만 있다면 언젠가는 해답을 찾을 것이다.

#### **실천하기**

- 가설을 세운후 실험으로 확인한다.
  - 실험으로 무엇을 알고 싶은지 분명히 안다.
  - 한 번에 하나만 수정한다.
  - 지금까지 시도해 본 것들을 기록한다.
  - 아무것도 무시하지 않는다.
- 제대로 되지 않는다면
  - 수정해도 효과가 없는 것 같다면 원했던 부분을 고친 게 아니다.
  - 가정을 확인한다.
  - 원인이 여러 개인 것은 아닌지? 내부 시스템을 변경하는 것은 아닌지?
- 진단을 확인한다.

### 문제의 핵심 > 수정

#### **리팩토링의 핵심 통찰은 무엇인가요? (page 99.)**

...
리팩토링에는 단순히 유용한 기법을 분류한 것 이상의 것이 있다. ...

- 광범위한 단위 테스트 스위트(unit test suite)가 안정망 역할을 해 줄 때에만 기존 코드를 안전하게 수정할 수 있다.
- 절대로 코드의 작동을 변경하면서 동시에 리팩토링하면 안 된다.
  다시 말해 코드의 작동을 변경하던지, 리팩토링을 하던지 둘 중 하나만 해야지 둘 다 동시에 하려고 하면 안된다. ...

**실천하기 (page 103.)**

- 버그 수정에는 다음 3가지 목표가 있다.
  - 문제 수정
  - 회귀 방지
  - (가독성, 아키텍처, 테스트 커버리지 같은) 전반적인 코드 품질을 유지하거나 향상시키기
- 깨끗한 소스에서 시작한다.
- 코드를 변경하기 전에 먼저 모든 테스트가 통과하는지 확인한다.
- 변경하기 전에 수정된 것을 어떻게 테스트할지 고민한다.
- 증상이 아닌 원인을 고친다.
- 리택토링한다. 하지만 기능을 변경하면서 동시에 하지마라.
- 로직을 하나 바꿀 때마다 체크인한다.

### 문제의 핵심 > 반영

#### **5 Why(page 107.)**

> 근본 원인 분석에 좋은 방법 중 하나가 '왜?'를 다섯 번 묻는 것이다.

예를 들어 다음과 같다.

- 소프트웨어가 크래시됐다. 왜?
  코드에서 데이터 전송 도중에 생긴 네트워크 문제를 제대로 처리하지 못했다. 왜?
- 네트워크 실패를 검사하는 단위 테스트가 없다. 왜?
- 코드를 구현하는 개발자가 그런 테스를 작성해야 한다는 것을 몰랐다. 왜?
- 네트워크 실패를 검사하는 단위 테스트가 하나도 없다. 왜?
- 초기 설계에 네트워크 실패가 고려되지 않았다.

#### **비난(page 108.)**

프로세스 문제를 먼저 나서서 찾아보는 것은 전반적인 품질 향상에 큰도움이 된다. 하지만 교훈을 얻는게 목적이지 비난하는게 목적이 아니라는 점에 주의하자.

물론 아마도 누군가가 뭔가를 망쳐놓았을 것이다. 하지만 실수는 누구나 한다. 손가락질 해봐야 전혀 생산적이지도 않고, 도움도 안된다.

비난하는 문화는성공에 꼭 필요한 팀워크를 갉아먹는다. 실수에 대해 공개 비판 당하거나 처벌받는 것을 두려워한다면 팀원들은 팀과, 더 넓게는 조직에 최선을 다하기보다 스스로를 지키는 데 급급하기 시작할 것이다. 최악의 경우 거짓말하고 희생얄을 찾는 등의 여러 문제가 생길 수 있다.

모범을 보여 이끄는 방법은 좋은 의도에서든 나쁜 의도에서든 강력하다. 짜증나는 버그의 원인을 찾은 후에 범인에게 큰 소리로 불평하기 시작하면 다른 팀원들도 그대로 따라할 것이다. 하지만 반대로 내가 실수한 문제가 밝혀졌을 때 잘못을 인정하고 '내 탓이요'리고 한다면 사람들에게 버그 때문에 부끄러워 할 거 없다는 점을 몸소 보여줄 수 있다. 문제를 찾은 후에 이를 어떻게 처리할 것인가가 그 문제가 있었다는 사실보다 훨씬 더 중요하다.
